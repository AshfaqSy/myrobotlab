<!-- ServoGui.html -->
<div class="servoContent">
    <div class="row">
        <div class="col-md-12">
            <uib-tabset active="activeTabIndex">
                <uib-tab heading="Controller" index="0">
                    <div class="row">
                        <div class="col-md-12">
                            <nav class="settingsbar preventDragSelect">
                                <span>
                                    <h6>
                                        You need to attach a controller to a servo.<br/>For example real and virtual controller.
                                    
                                    </h6>
                                </span>
                            </nav>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <table class="table">
                                <tr>
                                    <td>
                                        <select ng-disabled="service.controller" class="form-control" ng-model="selectedController">
                                            <option ng-repeat="controller in possibleControllers" value="{{controller}}">{{controller}} </option>
                                        </select>
                                    <td>
                                    <td>
                                        <!-- TODO - send pos ! ??? -->
                                        <button ng-show="!service.controller" class="btn btn-default" ng-click="attachController(selectedController, service.pin)">attach</button>
                                        <button ng-show="service.controller" class="btn btn-default" ng-click="msg.detach()">detach</button>
                                    </td>
                                    <td>Pin</td>
                                    <td>
                                        <select class="form-control" ng-model="service.pin" ng-options="item for item in pinList">
                                            <option>{{item}}</option>
                                        </select>
                                    </td>
                                    <td>Enable</td>
                                    <td>
                                        <toggle class="miniBTN" ng-model="service.enabled" ng-change="service.enabled?msg.enable():msg.disable()" on="enabled" off="disabled"/></toggle>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <!-- /.col-md-12 -->
                    </div>
                    <!-- /.row -->
                </uib-tab>
                <uib-tab select="refreshSlider()" heading="Basic" index="1">
                    <!-- ------------------ Basic ------------------ -->
                    <table class="table tableBasic preventDragSelect" style="margin-bottom: 0px!important;">
                        <tbody>
                            <tr>
                                <td>
                                    Sweep                                    
                                    
                                    <!-- ---- FIXME ---- WHEN SWEEPING IT SHOULD NOT AUTODISABLE-->
                                    <toggle ng-model="toggleSweep" class="miniBTN" title="Servo will move from one position to the opposite" ng-change="service.isSweeping?msg.stop():msg.sweep()" on="" off="" size="btn-lg"/>
                                </td>
                                <td>
                                    Speed
                                    <rzslider class="custom-slider3 speedSlider" rz-slider-model="speedSlider.value" rz-slider-options="speedSlider.options"/>
                                </td>
                            </tr>
                            <tr class="valuesRow">
                                <td></td>
                                <td>Speed = {{speedDisplay}} °/s</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="verticalSpacerBasic">
                            <!-- spacer to get the same vertical position of slider in Advacend Tab -->
                            </div>
                            <div class="sliderContainer">
                                <!-- sliderContainer -->
                                <!--<div ng-show="!service.enabled" id="servoMask"></div>-->
                                <div class="limitsZone">
                                    <!-- servo status -->
                                    <div class="servoPosition" class="preventDragSelect" style="left: calc(100% - (({{100 -(service.currentOutputPos.toFixed(2)*100/180)}}%) + 1px));">
                                        <span class="preventDragSelect">{{service.currentOutputPos.toFixed(2)}}º</span>
                                        <div class="servoCursor"></div>
                                    </div>
                                    <div class="restLabel" style="left: calc(100% - (({{100 -(service.rest*100/180)}}%) + 1px));">
                                        Rest
                                    <div class="restCursor"></div>
                                    </div>
                                    <div ng-show="service.enabled" class="preventDragSelect">
                                        <div class="energizedZone">
                                            <!-- Energized -->
                                            <div title="the servo is energized" class="energizedBar progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                                                <span class="glyphicon glyphicon-flash"></span>
                                                ENERGIZED     
                                            
                                            
                                            </div>
                                        </div>
                                    </div>
                                    <!-- <div id="outputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(limits.minValue*100/180)}}%)); width: calc(100% - ({{100 -((limits.maxValue-limits.minValue)*100/180)}}%));"></div> -->
                                    <div class="outputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(service.mapper.minY*100/180)}}%)); width: calc(100% - ({{100 -((service.mapper.maxY-service.mapper.minY)*100/180)}}%));"></div>
                                    <!-- <div id="inputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(limits.minValue*100/180)}}%)); width: calc(100% - ({{100 -((limits.maxValue-limits.minValue)*100/180)}}%));"></div> -->
                                    <div class="inputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(service.mapper.minX*100/180)}}%)); width: calc(100% - ({{100 -((service.mapper.maxX-service.mapper.minX)*100/180)}}%));"></div>
                                </div>
                                <rzslider class="custom-slider2 sliderPosition" rz-slider-model="pos.value" rz-slider-options="pos.options"/>
                            </div>
                            <!-- /sliderContainer -->
                        </div>
                        <!-- /.col-md-12 -->
                    </div>
                    <!-- /.row -->
                    <!-- <div class="verticalSpacer"></div> -->
                </uib-tab>
                <uib-tab select="refreshSlider()" heading="Limits" index="2">
                    <!-- ------------------ Limits ------------------ -->
                    <table class="table tableLimits preventDragSelect" style="margin-bottom: 0px!important;">
                        <tbody>
                            <tr>
                                <td>Input</td>
                                <td>
                                    <label class="label btn-input">
                                        Min<br>{{service.mapper.minX}} 
                                    </label>
                                </td>
                                <td>
                                    <label class="label btn-input">
                                        Max<br>{{service.mapper.maxX}} 
                                    </label>
                                </td>
                                <td>
                                    <label class="label btn-rest">
                                        Rest <br>{{service.rest}} 
                                    </label>
                                </td>
                                <td>Output</td>
                                <td>
                                    <label class="label btn-output">
                                        Min<br>{{service.mapper.minY}} 
                                    </label>
                                </td>
                                <td>
                                    <label class="label btn-output">
                                        Max<br>{{service.mapper.maxY}} 
                                    </label>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="verticalSpacerLimits">
                    <!-- spacer to get the same vertical position of slider in Basic Tab -->
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="sliderContainer">
                                <!-- sliderContainer -->
                                <!--<div ng-show="!service.enabled" id="servoMask"></div>-->
                                <div class="limitsZone">
                                    <!-- servo status -->
                                    <div class="servoPosition" class="preventDragSelect" style="left: calc(100% - (({{100 -(service.currentOutputPos.toFixed(2)*100/180)}}%) + 1px));">
                                        <span class="preventDragSelect">{{service.currentOutputPos.toFixed(2)}}º</span>
                                        <div class="servoCursor"></div>
                                    </div>
                                    <div class="restLabel" style="left: calc(100% - (({{100 -(service.rest*100/180)}}%) + 1px));">
                                        Rest
                                    <div class="restCursor"></div>
                                    </div>
                                    <div ng-show="service.enabled" class="preventDragSelect">
                                        <div class="energizedZone">
                                            <!-- Energized -->
                                            <div title="the servo is energized" class="energizedBar progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                                                <span class="glyphicon glyphicon-flash"></span>
                                                ENERGIZED                                            
                                            
                                            </div>
                                        </div>
                                    </div>
                                    <!-- <div id="outputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(limits.minValue*100/180)}}%)); width: calc(100% - ({{100 -((limits.maxValue-limits.minValue)*100/180)}}%));"></div> -->
                                    <div class="outputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(service.mapper.minY*100/180)}}%)); width: calc(100% - ({{100 -((service.mapper.maxY-service.mapper.minY)*100/180)}}%));"></div>
                                    <!-- <div id="inputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(limits.minValue*100/180)}}%)); width: calc(100% - ({{100 -((limits.maxValue-limits.minValue)*100/180)}}%));"></div> -->
                                    <div class="inputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(service.mapper.minX*100/180)}}%)); width: calc(100% - ({{100 -((service.mapper.maxX-service.mapper.minX)*100/180)}}%));"></div>
                                </div>
                                <rzslider class="custom-slider2 sliderPosition" rz-slider-model="pos.value" rz-slider-options="pos.options"/>
                                <br>
                                Rest
                                <rzslider class="custom-slider sliderPosition" rz-slider-model="restSlider.value" rz-slider-options="restSlider.options"/>
                                <br>
                                Input                                     
                                 - {{lockInputOutput?'UnLocked':'Locked'}} {{lockInputOutput}}
                                 <toggle class="miniBTN" title="Input limits will be locked with output" ng-model="lockInputOutput" ng-change="toggleLock()" on="Locked" off="UnLocked"></toggle>
                                <rzslider class="custom-slider inputColor" rz-slider-model="inputSlider.minValue" rz-slider-high="inputSlider.maxValue" rz-slider-options="inputSlider.options"/>
                                <br>
                                Output
                                <rzslider class="custom-slider inputColor" rz-slider-model="outputSlider.minValue" rz-slider-high="outputSlider.maxValue" rz-slider-options="outputSlider.options"/>
                                <br>
                            </div>
                            <!-- /sliderContainer -->
                        </div>
                        <!-- /.col-md-12 -->
                    </div>
                    <!-- /.row -->
                </uib-tab>
                <uib-tab select="refreshSlider()" heading="Advanced" index="3">
                    <!-- ------------------ Advanced ------------------ -->
                    <table class="table tableAdvanced preventDragSelect">
                        <tbody>
                            <tr>
                                <td>
                                    Auto-disable
                                    <toggle ng-model="service.autoDisable" class="miniBTN" ng-change="msg.setAutoDisable(service.autoDisable)" on="" off="" size="btn-lg"/>
                                    <rzslider class="custom-slider3 autoDisableSlider" ng-click="" rz-slider-model="autoDisableSlider.value" rz-slider-options="autoDisableSlider.options"/>
                                </td>
                                <td>
                                    Blocking                                    
                                    
                                    <!-- ---- FIXME ---- -->
                                    <toggle ng-model="toggleBlocking" class="miniBTN" title="Servo will block until the current moveTo is finished" ng-change="!service.isBlocking?msg.isBlocking(false):msg.isBlocking(true)" on="" off="" size="btn-lg"/>
                                </td>
                                <td>
                                    Invert
                                    
                                    <!-- ---- FIXME ---- -->
                                    <toggle ng-model="service.mapper.inverted" class="miniBTN" title="This will invert servo direction" ng-change="msg.setInverted(service.mapper.inverted)" on="" off="" size="btn-lg"/>
                                </td>
                                <td>Encoder</td>
                                <td>
                                    <select class="form-goup form-control" title="Encoders list">
                                        <option selected>TimeEncoder</option>
                                    </select>
                                </td>
                            </tr>
                            <tr class="valuesRow">
                                <td>Timeout = {{autoDisableSlider.value}} s</td>
                                <td colspan="4"></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="verticalSpacerAdvanced">
                    <!-- spacer to get the same vertical position of slider in Basic Tab -->
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="sliderContainer">
                                <!-- sliderContainer -->
                                <!--<div ng-show="!service.enabled" id="servoMask"></div>-->
                                <div class="limitsZone">
                                    <!-- servo status -->
                                    <div class="servoPosition" class="preventDragSelect" style="left: calc(100% - (({{100 -(service.currentOutputPos.toFixed(2)*100/180)}}%) + 1px));">
                                        <span class="preventDragSelect">{{service.currentOutputPos.toFixed(2)}}º</span>
                                        <div class="servoCursor"></div>
                                    </div>
                                    <div class="restLabel" style="left: calc(100% - (({{100 -(service.rest*100/180)}}%) + 1px));">
                                        Rest
                                    <div class="restCursor"></div>
                                    </div>
                                    <div ng-show="service.enabled" class="preventDragSelect">
                                        <div class="energizedZone">
                                            <!-- Energized -->
                                            <div title="the servo is energized" class="energizedBar progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                                                <span class="glyphicon glyphicon-flash"></span>
                                                ENERGIZED                                            
                                            
                                            
                                            </div>
                                        </div>
                                    </div>
                                    <!-- <div id="outputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(limits.minValue*100/180)}}%)); width: calc(100% - ({{100 -((limits.maxValue-limits.minValue)*100/180)}}%));"></div> -->
                                    <div class="outputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(service.mapper.minY*100/180)}}%)); width: calc(100% - ({{100 -((service.mapper.maxY-service.mapper.minY)*100/180)}}%));"></div>
                                    <!-- <div id="inputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(limits.minValue*100/180)}}%)); width: calc(100% - ({{100 -((limits.maxValue-limits.minValue)*100/180)}}%));"></div> -->
                                    <div class="inputLimit" class="preventDragSelect" style="left: calc(100% - ({{100 -(service.mapper.minX*100/180)}}%)); width: calc(100% - ({{100 -((service.mapper.maxX-service.mapper.minX)*100/180)}}%));"></div>
                                </div>
                                <rzslider class="custom-slider2 sliderPosition" rz-slider-model="pos.value" rz-slider-options="pos.options"/>
                            </div>
                            <!-- /sliderContainer -->
                        </div>
                        <!-- /.col-md-12 -->
                    </div>
                    <!-- /.row -->
                </uib-tab>
            </uib-tabset>
        </div>
        <!-- /.col-md-12 -->
    </div>
    <!-- /.row -->
</div>
<script>
    function speedSlider(servo, value) {
        if (value == 501) {
            value = "<b>Max Speed</b>";
        } else {
            value = 'Speed = ' + value + 'º per second';
        }
        document.getElementById("speedValue" + servo).textContent = value;
        // And set de value in angular
    }
</script>
<!-- /#servoContent -->
<!-- /ServoGui.html -->
